---
layout: post
title:  "í”„ë¦¬ì˜¨ë³´ë”© ì½”ìŠ¤ 2ì£¼ì°¨ ê³¼ì œ ë¦¬íŒ©í† ë§"
description: ""
featured: false
author: admin
categories: [ TIL ]
tags: [ì›í‹°ë“œ í”„ë¦¬ì˜¨ë³´ë”© ì½”ìŠ¤]
image: "https://user-images.githubusercontent.com/67324487/207404862-179e76be-a2af-4354-ae19-26e6d88a3fc6.png"
# beforetoc: ""
toc: true
# rating: 3
hidden: false
---
# 2ì£¼ì°¨ ë¯¸ìŠ¤í„°ì¹´ë©œ ê³¼ì œ
## 1st ProblemğŸ’¥

```jsx
// src/Pages/List/List.js

handleClick(product) {
    let data = []
    data = GetDataFromLocalStorage(WATCHED) || []
    if (data) {
      for (let i = 0; i < data.length; i++) {
        if (data[i].index === product.index) {
          if (data[i].interest === false) {
            alert(ALERT_NOT_INTERESTING_PRODUCT)
            return
          } else {
            data[i].date = product.date
            MoveAfterVisit(data, `/product/${product.index}`, this.props)
            return
          }
        }
      }
      data.push(product)
      MoveAfterVisit(data, `/product/${product.index}`, this.props)
      return
    }
    data.push(product)
    MoveAfterVisit(data, `/product/${product.index}`, this.props)
  }
```

- í•˜ë‚˜ì˜ í•¨ìˆ˜ê°€ ìˆ˜í–‰í•˜ëŠ” ê¸°ëŠ¥ì´ ë„ˆë¬´ ë§ìŒ â†’ í•œ ëˆˆì— ì–´ë–¤ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ëŠ”ì§€ ì•Œê¸° ì–´ë ¤ì›€, ì´í•´í•˜ëŠ” ë° ì‹œê°„ ì†Œìš”

- LocalStorageì—ì„œ ìƒí’ˆ ì¡°íšŒ ê¸°ë¡ì„ ë¶ˆëŸ¬ì™€ì„œ ë³€ìˆ˜ì— í• ë‹¹í•  ë•Œ Util functionì„ ì´ìš©í•˜ëŠ”ë°, ë§¤ë²ˆ ìƒˆë¡œ ë³€ìˆ˜ë¥¼ ë§Œë“¤ê³ , ì´ˆê¸°í™”í•˜ëŠ” ê³¼ì •ì—ì„œ ë¶ˆí•„ìš”í•œ ì½”ë“œê°€ ë°œìƒ


### Solutionâœ…

```jsx
// src/utils/GetDataFromLocalStorage.js

const GetDataFromLocalStorage = (key) => {
  return JSON.parse(localStorage.getItem(key)) || []
}
export default GetDataFromLocalStorage
```

- ë§Œì•½ í•´ë‹¹ keyë¥¼ ê°–ëŠ” ë°ì´í„°ê°€ LocalStorageì— ì €ì¥ë˜ì–´ ìˆì§€ ì•Šì„ ê²½ìš° Util í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ìì²´ì ìœ¼ë¡œ ë¹ˆ ë°°ì—´ì„ ë³€ìˆ˜ì— í• ë‹¹í•˜ë„ë¡ í•¨ 
â†’ í•´ë‹¹ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ê³³ì—ì„œ undefinedê°€ ë°˜í™˜ë  ê²ƒì„ ëŒ€ë¹„í•˜ì—¬ êµ³ì´ ì¶”ê°€ë¡œ ë¹ˆ ë°°ì—´ì„ í• ë‹¹í•  ì¤€ë¹„ë¥¼ í•´ë‘˜ í•„ìš”ê°€ ì—†ì–´ì§

```jsx
  isWatched(product) {
    const watchedProduct =
      this.state.histories?.find(
        (history) => history.index === product.index
      ) || null
    return watchedProduct
  }

  deleteHistory(product) {
    const newWatchedHistory = this.state.histories.filter((history) => {
      return history !== product
    })
    console.log(newWatchedHistory)
    return newWatchedHistory
  }

  MoveAfterAddToWatched(history, product, idx) {
    history.push(product)
    MoveAfterPush(history, `/product/${idx}`, this.props)
  }

  handleClick(product) {
    const watchedProduct = this.isWatched(product)

    if (!watchedProduct) {
      this.MoveAfterAddToWatched(this.state.histories, product, product.index)
      return
    }
    if (watchedProduct?.interest) {
      const newWatchedHistory = this.deleteHistory(watchedProduct)
      this.MoveAfterAddToWatched(newWatchedHistory, product, product.index)
      return
    } else {
      alert(ALERT_NOT_INTERESTING_PRODUCT)
      return
    }
  }
```

- ê¸°ëŠ¥ ë³„ë¡œ í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì„œ í•˜ë‚˜ì˜ í•¨ìˆ˜ê°€ í•˜ë‚˜ì˜ ì¼ë§Œì„ í•  ìˆ˜ ìˆë„ë¡ í•¨

- 'í•´ë‹¹ ê°’ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš°(undefinedê°€ ì•„ë‹Œ ê²½ìš°)'ë¥¼ í‘œí˜„í•˜ê¸° ìœ„í•´ ë¬¼ìŒí‘œ ì‚¬ìš©
ex) watchedProduct?.interest


## 2nd ProblemğŸ’¥

```jsx
      const newProduct = this.state.wholeProducts[randomNum]
      const date = new Date()
      const tempObj = { index: randomNum, date: date, interest: true }
      const product = Object.assign(tempObj, newProduct)
      data.push(product)
      MoveAfterVisit(data, `${PRODUCT_URL}/${randomNum}`, this.props)
      return
```

- randomNumì„ indexë¡œ ê°€ì§€ëŠ” ìƒí’ˆì˜ ì¡°íšŒ ë‚´ì—­ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°, í•´ë‹¹ indexì˜ ìƒí’ˆ ì •ë³´ë¥¼ wholeProducts dataë¡œë¶€í„° ê²€ìƒ‰ í›„ ê°€ì ¸ì™€ì„œ parsing(index, date, interest ì •ë³´ ì¶”ê°€), LocalStorageì— parsingëœ ìƒí’ˆ ì •ë³´ ì¶”ê°€ í›„ í•´ë‹¹ ìƒí’ˆ ìƒì„¸ í˜ì´ì§€ë¡œ ë°©ë¬¸í•˜ëŠ” ë¡œì§

- í•´ë‹¹ ë¶€ë¶„ ë˜í•œ ì–´ë–¤ í•¨ìˆ˜ ì•ˆì— ë‹´ê¸´ ë¡œì§ì¸ë°, ë‹¨ì¼ ì±…ì„ ì›ì¹™ì„ ì§€í‚¤ê¸° ìœ„í•´ ë”°ë¡œ í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì„œ ë¶„ë¦¬í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ

### Solutionâœ…

- í•¨ìˆ˜ ì •ì˜

```jsx
  saveNewRandomProduct(data, randomNum) {
    const newProduct = this.state.wholeProducts[randomNum]
    const date = new Date()
    const tempObj = { index: randomNum, date: date, interest: true }
    const product = Object.assign(tempObj, newProduct)
    data.push(product)
    MoveAfterPush(data, `${PRODUCT_URL}/${randomNum}`, this.props)
  }
```

- ì‚¬ìš©

```jsx
      this.saveNewRandomProduct(data, randomNum)
      return
```

[repo link](https://github.com/nvrtmd/wanted-second-project/tree/refactor)